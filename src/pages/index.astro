---
import Layout from '../layouts/Layout.astro';
import { supabase, type Business } from '../lib/supabase';

const { data: businesses, error } = await supabase
  .from('businesses')
  .select('*')
  .order('created_at', { ascending: false });

if (error) {
  console.error('Error fetching businesses:', error);
}
---

<Layout title="Home">
  <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
    {businesses?.map((business: Business) => (
      <a 
        href={`/business/${business.id}`}
        class="block p-6 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow"
      >
        <h2 class="text-xl font-semibold text-gray-900">{business.name}</h2>
        <p class="mt-2 text-gray-600 line-clamp-2">{business.description}</p>
        <div class="mt-4 text-sm text-gray-500">
          <p>{business.category}</p>
          <p>{business.address}</p>
        </div>
      </a>
    ))}
  </div>
</Layout> 